# 从海量Key里查询出某一个固定前缀的Key

## 使用keys对线上业务的影响

* KEY pattern:查找所有符合给定模式pattern的key
  * KEY指令一次性返回所有匹配的key
  * 键的数量过大会使服务卡顿
  * ![](/keys/1.png)

使用SCAN指令可以无堵塞获取匹配的keys列表：SCAN cursor \[MATCH pattern\] \[COUNT count\]

* 基于游标的迭代器，需要基于上一次的游标延续之前的迭代过程
* 以0作为游标开始一次新的迭代，直到命令返回游标0完成一次遍历
* 不保证每次执行都返回某个给定数量的元素，支持模糊查询
* 一次返回的数量不可控，只能是大概率符合count参数



实际上每一次设定的时候返回的数量和指针值都不一样，在java中实际上可以使用Set来存储数据，保证数据唯一，以防重复

![](/keys/2.png)

